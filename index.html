<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscribe Prototype</title>
    <!-- Include D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- StyleSheets-->
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/topbar.css">
    <link rel="stylesheet" href="styles/mainweb.css">

    <!-- Scripts-->

    <script src="javascript/entryCreation.js"></script>
</head>

<body>

    <!-- Large title screen -->
    <div class="title-screen">
        <h1>Welcome to My Website</h1>
        <p>This is a brief description of what the website is about.</p>
    </div>



    <div id="csv-container">


        <div id="main-web"></div>

        <div id="word-list">
            <!-- List of words goes here -->
            <h2>Sample Word List</h2>
            <ul>
                <li>Battle School</li>
                <li>Ender Wiggin</li>
                <li>Formic</li>
                <li>Command School</li>
                <li>Peter Wiggin</li>
                <li>Mazer Rackham</li>
                <li>Giant's Drink</li>
                <li>Third Invasion</li>
                <li>Dragon Army</li>
                <li>Valentine Wiggin</li>
                <li>The Mind Game</li>
                <li>Buggers</li>
                <li>The Battle Room</li>
                <li>Salamander Army</li>
                <li>Locke and Demosthenes</li>
                <li>IF (International Fleet)</li>
                <li>Bugger War</li>
                <li>Graff and Anderson</li>
                <li>Null Gravity</li>
                <li>Ender's Jeesh</li>

                <!-- Add more words as needed -->
            </ul>
        </div>
    </div>


    <script>


        //storing inputted data

        var width = document.getElementById("main-web").offsetWidth;
        var height = document.getElementById("main-web").offsetHeight;
        console.log(width);
        console.log(height);

        // Create SVG element
        const svg = d3.select("#main-web")
            .append("svg")
            .attr("width", width)
            .attr("height", height);


        // Create a function to handle keyboard shortcuts
        function handleKeyPress(event) {
            // Check if the key pressed is 'n' and either Ctrl (for Windows/Linux) or Command (for macOS) is pressed
            if ((event.key === 'b' || event.key === 'B') && (event.ctrlKey || event.metaKey)) {
                // Prevent default behavior of the browser (e.g., opening a new tab)
                event.preventDefault();

                popupGroup.style("display", "block");
                popupGroup.raise();

            }
        }
        // Listen for keydown events on the window
        window.addEventListener('keydown', handleKeyPress);


        const buttonGroup = svg.append("g")
            .attr("transform", "translate(10, 10)")
            .on("click", function () {
                popupGroup.style("display", "block");
                popupGroup.raise();

            });


        buttonGroup.append("rect")
            .attr("class", "button")
            .attr("width", 100)      // width of the rectangle
            .attr("height", 40)      // height of the rectangle
            .style("cursor", "pointer"); // change cursor to pointer on hover
        // Add click behavior


        // Append text to the group
        buttonGroup.append("text")
            .attr("class", "button-text")
            .attr("x", 5) // x-coordinate of the text relative to the group
            .attr("y", 25) // y-coordinate of the text relative to the group
            .style("cursor", "pointer") // change cursor to pointer on hover
            .text("New Entry");



        //array of all created entries
        entryArray = [];
        counterCreated = 0;
        selectedEntry = -1;

        function selectEntry(entryID) {
            entryArray.forEach(function (entry) {
                entry.select("#outerBox").attr("display", "none");
            });

            selectedEntry = entryID;
            d3.select("#" + entryID).select("#outerBox").attr("display", "block");

        }




        // Create popup container as a group element within the SVG
        const popupGroup = svg.append('g')
            .attr("transform", "translate(400, 100)")
            .attr('class', 'popup-group');

        // Create popup background rectangle
        popupGroup.append('rect')
            .attr('class', 'popup-background')
            .attr('x', 100)
            .attr('y', 0)
            .attr('width', 300)
            .attr('height', 400);

        // Text input with character limit
        popupGroup.append('foreignObject')
            .attr('x', 150)
            .attr('y', 100)
            .attr('width', 200)
            .attr('height', 30)
            .html('<input type="text" maxlength="20" placeholder="Enter text (max 20 characters)" class="input-field">');

        // Larger text input without character limit
        popupGroup.append('foreignObject')
            .attr('x', 150)
            .attr('y', 150)
            .attr('width', 200)
            .attr('height', 200)
            .html('<textarea placeholder="Enter text" class="textarea-field"></textarea>');

        // Submit button
        const submitButton = popupGroup.append('g')
            .attr('class', 'popup-submit-button')
            .attr('transform', 'translate(150, 360)')
            .style('cursor', 'pointer')
            .on('click', function () {
                const textInput1Value = d3.select('input').property('value');
                const textInput2Value = d3.select('textarea').property('value');

                if (textInput1Value.trim() === '') {
                    alert('Please enter text in the top field.');
                    return;
                }



                createDraggableEntry(svg, textInput1Value);
                popupGroup.style('display', 'none');
            });


        createDraggableEntry(svg, "teeest");

        submitButton.append('rect')
            .attr('width', 80)
            .attr('height', 30);

        submitButton.append('text')
            .attr('x', 40)
            .attr('y', 20)
            .text('Submit');

        // Cancel button
        const cancelButton = popupGroup.append('g')
            .attr('class', 'popup-cancel-button')
            .attr('transform', 'translate(270, 360)')
            .style('cursor', 'pointer')
            .on('click', function () {
                popupGroup.style('display', 'none');
            });

        cancelButton.append('rect')
            .attr('width', 80)
            .attr('height', 30);

        cancelButton.append('text')
            .attr('x', 40)
            .attr('y', 20)
            .text('Cancel');

        // Function to show the popup
        function showPopup() {
            popupGroup.style('display', 'block');
        }

        // Add click event listener to the open button
        d3.select('#openButton').on('click', showPopup);



    </script>
</body>

</html>