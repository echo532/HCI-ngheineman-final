<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D3.js Bar Chart Example</title>
    <!-- Include D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* CSS styles for the chart */
        .bar {
            fill: steelblue;
        }

        .bar:hover {
            fill: orange;
        }

        #mainWeb svg {
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <h1>Inscribe prototype</h1>
    <div id="mainWeb"></div>

    <script>
        // Data
        const data = [10, 20, 30, 40, 50];
        const width = 800
        const height = 400

        // Create SVG element
        const svg = d3.select("#mainWeb")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        const buttonGroup = svg.append("g")
            .attr("transform", "translate(10, 10)")
            .on("click", function () {
                // Prompt the user for text input
                var userInput = prompt("Please enter some text:");

                // Check if the user entered any text
                if (userInput !== null) {
                    // Display the user input
                    createDraggableCircle(svg, userInput);
                } else {
                    // Handle case where user cancels the prompt
                    alert("No input provided.");
                }
            });

        buttonGroup.append("rect")
            .attr("width", 100)      // width of the rectangle
            .attr("height", 40)      // height of the rectangle
            .attr("fill", "gray")    // fill color of the rectangle
            .style("cursor", "pointer"); // change cursor to pointer on hover
        // Add click behavior


        // Append text to the group
        buttonGroup.append("text")
            .attr("x", 5) // x-coordinate of the text relative to the group
            .attr("y", 25) // y-coordinate of the text relative to the group
            .attr("font-size", "14px")
            .attr("fill", "white")
            .style("cursor", "pointer") // change cursor to pointer on hover
            .text("New Entry");


        function createDraggableCircle(svg, inputText) {
            // Append a circle to the SVG

            const entry = svg.append("g")
                .attr("transform", "translate(200, 200)")


            entry.append("rect")
                .attr("width", 100)      // width of the rectangle
                .attr("height", 40)      // height of the rectangle
                .attr("fill", "black")    // fill color of the rectangle
                .style("cursor", "pointer"); // change cursor to pointer on hover

            // Append text to the group
            entry.append("text")
                .attr("x", 5) // x-coordinate of the text relative to the group
                .attr("y", 25) // y-coordinate of the text relative to the group
                .attr("font-size", "14px")
                .attr("fill", "white")
                .style("cursor", "pointer") // change cursor to pointer on hover
                .text(inputText);

            // Define drag behavior
            const dragHandler = d3.drag()
                .on("start", function (event) {
                    // Record the starting position of the group
                    d3.select(this).attr("initialX", event.x);
                    d3.select(this).attr("initialY", event.y);
                })
                .on("drag", function (event) {
                    // Calculate the new position of the group based on the drag movement
                    const dx = event.x - parseFloat(d3.select(this).attr("initialX"));
                    const dy = event.y - parseFloat(d3.select(this).attr("initialY"));
                    const newX = parseFloat(d3.select(this).attr("transform").split(",")[0].split("(")[1]) + dx;
                    const newY = parseFloat(d3.select(this).attr("transform").split(",")[1].split(")")[0]) + dy;

                    // Update the position of the group
                    d3.select(this).attr("transform", "translate(" + newX + "," + newY + ")");

                    // Update the initial position for the next drag event
                    d3.select(this).attr("initialX", event.x);
                    d3.select(this).attr("initialY", event.y);
                });

            // Apply drag behavior to the circle
            entry.call(dragHandler);
        }


    </script>
</body>

</html>